<!DOCTYPE html>
<html>
<head>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="">
<meta name="author" content="">

<link rel="stylesheet" href="./static/semantic/css/semantic.min.css"/>
<link href="./static/asset/prettify.css" rel="stylesheet">
<link href="./static/toc/toc.css" rel="stylesheet">
<link rel="stylesheet" href="./static/parm.css"/>
<link rel="stylesheet" href="./static/asset/sons-of-obsidian.css"/>
<link rel="stylesheet" href="./static/ui.totop.css"/>

<title>Blog 基本内容展示 - Avalon Learning</title>
</head>
<body>



<!-- Navbar
================================================== -->
<div class="navbar">
  <div class="ui small secondary inverted borderless menu">
    
    <a class="active item" href="./index.html">Home</a>
    
    <div class="right menu">
      
        
<div class="item">
  <div class="ui icon input">
    <form id="searchform">
    <input name="q" type="text" placeholder="Search...">
    </form>
  </div>
</div>

      
      <div class="ui dropdown item">
        Select Languages <i class="icon dropdown"></i>
        <div class="menu">
          <!--<a class="item language" href="#" data-lang="en">English</a>-->
          <a class="item language" href="#" data-lang="zh_CN">中文</a>
        </div>
      </div>
    </div>
  </div>
</div>


<div class="ui divided grid">
    <div class="four wide column" id="side-bar">
        <div id="toc" class="content"></div>
    </div> 
    
    <div class="twelve wide column" id="markdown-content">
    
        <div class="chapter-prev chapter-top">
    <a prev-chapter href="./hello_avalon.html"><i class="icon-arrow-left"></i> Hello, Avalon</a>
</div>
<div class="chapter-next chapter-top">
    <a next-chapter href="./filter.html">使用 filter <i class="icon-arrow-right"></i></a>
</div>
        
        <h1 id="title_1">Blog 基本内容展示<a class="anchor" href="#title_1">&para;</a></h1>
<h2 id="title_1-1">MVVM 的一些思考<a class="anchor" href="#title_1-1">&para;</a></h2>
<p>作为初学者，我们没必要对于MVVM的概念刨根问底，不过我们需要知道它的大概工作方式 或原理。在接触 Avalon 之前可能很多人已经用过象 jquery 这样的ajax库，所以可能更习 惯所有的事情都由你来控制，比如：在向后台请求数据之后，调用 jquery 的插件或手工 通过 javascript 来处理数据，在DOM上添加或修改相应的元素，以实现数据的展示。</p>
<p>但是使用了 Avalon 这样的 MVVM 库之后，事情改变了，展示和数据加工可以很好的分离， Model 负责数据的加工，DOM模板（即 <code>ms-controller</code>, <code>ms-</code> 这样的属性）负责展示， 而数据和模板之间的动态更新，以至于同步，完全由 Avalon 这样的库来自动处理了（当然 特殊情况下要手工触发）。</p>
<p>并且展示与 DOM 完美的结合，通过设置不同的 <code>ms-</code> 属性来实现如：数据显示、事件响应、 属性变化、CSS的修改、引入其它的模板、调用UI组件、动画等功能，基本上几乎所有与UI 相关的处理都可以使用 avalon 来支持。</p>
<p>不过，因为具体的渲染过程不再受你的控制，所以也带来一定的理解或处理上的困难，比如：</p>
<ul>
<li>什么时候，相关数据的渲染完成？因为你可能需要在 DOM 都处理好之后再做一些加工</li>
<li>如何做一些初始化的工作？</li>
<li>其它与时序相关的处理</li>
</ul>
<p>不过凡事有弊有利（当然上面的问题也不是没有解决办法，也许不太完美，但是可以不断改 进），这种机制带来的好处我认为有：</p>
<ul>
<li>不同的处理关注的重点更清晰，更易于维护</li>
<li>可以极大的减少代码量</li>
<li>方便提升页面的动态和交互能力，有利于用户体验的实现</li>
</ul>
<p>前面讲了一些有关 MVVM 的一些基本的原理（当然还不具体），不易理解的地方以及我认为 它的一些优势。</p>
<p>下面让我们来看一个具体的问题。</p>
<h2 id="title_1-2">问题设计<a class="anchor" href="#title_1-2">&para;</a></h2>
<p>比如我有一篇博客要展示它的基本内容，基本内容可能包括：</p>
<ul>
<li>标题 - subject</li>
<li>内容 - content</li>
<li>作者 - author</li>
<li>日期 - publish_date</li>
<li>评论数 - comment_count</li>
</ul>
<p>那么使用 Avalon 如何在页面上展示它呢？</p>
<h2 id="title_1-3">页面设计<a class="anchor" href="#title_1-3">&para;</a></h2>
<p>先让我们抛开 Avalon ，把博客展示页面先设计出来，因为只是展示，所以不会太复杂。</p>
<p>先让我们看一下设计好的页面效果：</p>
<p><img src="images/blog_basic_01.png"/>
</p>
<p>这里 <code>{{}}</code> 的内容将是我们要进行替換的地方。整个布局是使用了 <a href="http://semantic-ui.com/" class="outter">semantic-ui</a> 这个 CSS 框架，样子还是比较好看的。具体的CSS样式不再说明了，只看一下整个页面的代码。</p>
<pre class="prettyprint linenums"><code>&lt;!doctype html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-type" content="text/html; charset=utf-8" /&gt;
&lt;script type="text/javascript" src="jquery-1.10.2.min.js"&gt;&lt;/script&gt;
&lt;link rel="stylesheet" type="text/css" href="../zh_CN/static/semantic/css/semantic.min.css"/&gt;
&lt;script type="text/javascript" src="../zh_CN/static/semantic/javascript/semantic.min.js"&gt;&lt;/script&gt;
&lt;link rel="stylesheet" type="text/css" href="blog.css"/&gt;
&lt;title&gt;Avalon Learning Blog&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;!-- HEADER --&gt;
&lt;div class="head"&gt;
    &lt;h1 class="ui header"&gt;Avalon Learning Blog
        &lt;div class="sub header"&gt;带你快速走进 Avalon 的世界&lt;/div&gt;
    &lt;/h1&gt;
&lt;/div&gt;
&lt;!-- Blog正文 --&gt;
&lt;div class="ui attached bottom segment" id="blogs"&gt;
    &lt;div class="ui stacked segment blog"&gt;
        &lt;div class="blog-body"&gt;
        &lt;h2 class="ui header"&gt;
            &lt;div class="content"&gt;
                {{subject}}
                &lt;div class="sub header"&gt;{{author}} • {{publish_date}} • &lt;span class="ui label"&gt;&lt;i class="comment icon"&gt;&lt;/i&gt; {{comment_count}}&lt;/span&gt;&lt;/div&gt;
            &lt;/div&gt;
        &lt;/h2&gt;
        &lt;div class="ui divider"&gt;&lt;/div&gt;
        &lt;div class="blog-content"&gt;{{content}}&lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>

<p>这个页面没有特别需要讲解的，因为没有一点用到 Avalon 的东西。现在就让我一点点添加 相应的内容。</p>
<h2 id="title_1-4">使用 Avalon 来处理页面<a class="anchor" href="#title_1-4">&para;</a></h2>
<h3 id="title_1-4-1">引入 avalon.js<a class="anchor" href="#title_1-4-1">&para;</a></h3>
<p>在 <code>&lt;head&gt;</code> 的最下面添加</p>
<pre class="prettyprint "><code>&lt;script src="avalon.js"&gt;&lt;/script&gt;</code></pre>
<h3 id="title_1-4-2">定义 controller<a class="anchor" href="#title_1-4-2">&para;</a></h3>
<p>在 <code>&lt;div id="blogs"&gt;</code> 上添加 <code>ms-controller="blog"</code> ，这样我们就定义了一个控制 器，名字为 <code>blog</code> 。</p>
<h3 id="title_1-4-3">编写 Model<a class="anchor" href="#title_1-4-3">&para;</a></h3>
<pre class="prettyprint linenums"><code>...
&lt;script&gt;
avalon.define("blog", function(vm){
    vm.subject = "Blog Title";
    vm.author = "张三";
    vm.publish_date = new Date('2014/3/15');
    vm.comment_count = 0;
    vm.content = "&lt;h2&gt;这是一个测试的博客&lt;/h2&gt;" +
        "&lt;p&gt;这是内容 1&lt;/p&gt;" +
        "&lt;p&gt;这是内容 2&lt;/p&gt;" +
        "&lt;p&gt;这是内容 3&lt;/p&gt;" +
        "&lt;p&gt;这是内容 4&lt;/p&gt;"
        ;
});
&lt;/script&gt;
...</code></pre>

<p>其实很简单，只是在 <code>vm</code> 上定义了一些属性，与DOM中的插值表达式的变量对应。</p>
<h3 id="title_1-4-4">查看效果<a class="anchor" href="#title_1-4-4">&para;</a></h3>
<p><img src="images/blog_basic_02.png"/>
</p>
<p>不过，你可能看到，日期和内容显示的地方都不是我们想要的，日期显示我希望是 <code>yyyy-mm-dd</code> 。 而内容中，因为有 HTML 的标签也被转义了，我希望不被转义。</p>
<p>如何处理，我们将在下一章节学习。</p>
<h3 id="title_1-4-5">调整 vm 结构<a class="anchor" href="#title_1-4-5">&para;</a></h3>
<p>上面的代码我们使用了简单的方式，直接在 <code>vm</code> 上绑定属性。现在我们改为 object 的 定义形式（类似于 Hash 对象）。</p>
<pre class="prettyprint linenums"><code>...
&lt;script&gt;
avalon.define("blog", function(vm){
    vm.blog = {subject: "Blog Title",
        author: "张三",
        publish_date: new Date('2014/3/15'),
        comment_count: 0,
        content: "&lt;h2&gt;这是一个测试的博客&lt;/h2&gt;" +
        "&lt;p&gt;这是内容 1&lt;/p&gt;" +
        "&lt;p&gt;这是内容 2&lt;/p&gt;" +
        "&lt;p&gt;这是内容 3&lt;/p&gt;" +
        "&lt;p&gt;这是内容 4&lt;/p&gt;"
    }
});
&lt;/script&gt;
...</code></pre>

<p>然后修改 DOM 中的插值表达式相应的变量前添加 <code>blog.</code> 。</p>
<p>可以看到， Avalon 中可以使用复杂的对象结构。</p>
<h2 id="title_1-5">观看演示代码<a class="anchor" href="#title_1-5">&para;</a></h2>
<ul>
<li><a href="../demos/blog_basic.html" class="inner">演示代码1 demos/blog_basic.html</a></li>
<li><a href="../demos/blog_basic_1.html" class="inner">演示代码2 demos/blog_basic_1.html</a></li>
<li><a href="../demos/blog_basic_2.html" class="inner">演示代码3 demos/blog_basic_2.html</a></li>
</ul>

        
        <div class="ui blue inverted small label">
            <i class="icon download"></i><a href="./blog_basic.md">View Source</a>
        </div>
        <div class="ui blue inverted small label">
            <i class="icon help link" data-html="<b>&larr;</b> Prev Chapter <b>&rarr;</b> Next Chapter<br/><b>h</b> Index Page"></i>
        </div>
        
        
    </div>
</div>

<div class="ui page grid">
    <div class="column">
    <!-- disqus -->
    
        <div id="disqus_thread" style="margin:20px;"></div>
 <script type="text/javascript">
     /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
     var disqus_shortname = 'avalonlearning'; // required: replace example with your forum shortname

     /* * * DON'T EDIT BELOW THIS LINE * * */
     (function() {
         var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
         dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
         (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
     })();
 </script>
 <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
 <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    
    </div>
</div>

<div class="ui page grid" id="footer">
    <div class="column">
    
<p>Designed by Limodou, Copyright 2014, Limodou</p>
<p>CSS framework <a href="https://github.com/twitter/bootstrap">Bootstrap</a>, Markdown parser lib <a href="https://github.com/limodou/par">Par</a> and this page is created by <a href="https://github.com/limodou/parm">Parm</a> tool.</p>

    </div>
</div>


<script>
var relpath = '.';
</script>

<script type="text/javascript" src="./static/jquery-1.7.2.min.js"></script>
<script type="text/javascript" src="./static/semantic/javascript/semantic.min.js"></script>
<script src="./static/asset/prettify.js"></script>
<script src="./static/toc/toc.js"></script>
<script src="./static/jquery.ui.totop.js"></script>
<script src="./static/jquery.hotkeys.js"></script>
<script src="./static/jquery.sticky-kit.min.js"></script>
<script src="./static/docs.js"></script>
<script src="./static/comment.js"></script>


    <script type="text/javascript">
   /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
   var disqus_shortname = 'avalonlearning'; // required: replace example with your forum shortname

   /* * * DON'T EDIT BELOW THIS LINE * * */
   (function () {
       var s = document.createElement('script'); s.async = true;
       s.type = 'text/javascript';
       s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
       (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
   }());
   </script>




    
<script type="text/javascript">
$(function(){
    var form = $('#searchform');
    form.submit(function(e){
        e.preventDefault();
        var wq=$('input[name="q"]').val();
        var link="http://www.google.com/search?q=site:limodou.github.io/avalon-learning/zh_CN "+wq;
        window.open(link);

    });
});
</script>



<script>
$(function(){
    $('.navbar .ui.dropdown').dropdown({
        on: 'hover'
    });
    $('a.language').on('click', function(){
        $.cookie('language', $(this).data('lang'), { expires: 360, path: '/' });
        window.location.href = "./../"+$(this).data('lang')+'/index.html';
    });
});
</script>
</body>
</html>
